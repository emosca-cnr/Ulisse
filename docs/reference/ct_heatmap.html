<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function elaborates the output of `gs_cross-talk()` 
function to represent the obtained cross-talks as an heatmap"><title>Function to plot the heatmap of cross-talk results — ct_heatmap • Ulisse</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to plot the heatmap of cross-talk results — ct_heatmap"><meta property="og:description" content="The function elaborates the output of `gs_cross-talk()` 
function to represent the obtained cross-talks as an heatmap"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Ulisse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Ulisse_bulk.html">Ulisse workflow 1: Pathway Cross-Talk analysis of bulk data</a>
    <a class="dropdown-item" href="../articles/Ulisse_enrich.html">ORA and GSEA with Ulisse</a>
    <a class="dropdown-item" href="../articles/Ulisse_sc.html">Ulisse workflow 2: Cell-cell cross-talk analysis on single cell data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Function to plot the heatmap of cross-talk results</h1>
      
      <div class="d-none name"><code>ct_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function elaborates the output of `gs_cross-talk()` 
function to represent the obtained cross-talks as an heatmap</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ct_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">ct</span>,</span>
<span>  color_by <span class="op">=</span> <span class="st">"ct_score"</span>,</span>
<span>  color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  color_level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  no_ct_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filtering <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">p_val</span>,</span>
<span>  <span class="va">FDR</span>,</span>
<span>  <span class="va">ct_val</span>,</span>
<span>  legend_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>  community <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  pal_community <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  row_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pal_row_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_name_side <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  column_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pal_column_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_name_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>  file_out <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file_width <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  file_height <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  units <span class="op">=</span> <span class="st">"mm"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ct</dt>
<dd><p>results obtained with `gs_cross-talk()` functions</p></dd>


<dt>color_by</dt>
<dd><p>name of the column to be plotted in the heatmap</p></dd>


<dt>color</dt>
<dd><p>vector of two colors used to build the gradient to color the heatmap, that are the colors of the two
number of `color_level`. If NULL, the function uses `lightyellow` and `red3`</p></dd>


<dt>color_level</dt>
<dd><p>vector of the two values to be used to create the gradient to color the heatmap. If not provided, 
the function uses minimum and maximum</p></dd>


<dt>no_ct_color</dt>
<dd><p>color that have to be used for the gene set pairs that shows no cross-talk (in the heatmap will have score = 0). If `NULL` the function
uses `whitesmoke`</p></dd>


<dt>filtering</dt>
<dd><p>logical, if the function have to plot all the edges or only the significant ones. If `TRUE`, the function uses `p_val, FDR` and `ct_val` to identify the 
significant ones, that are plotted with a solid line, and the not significant with a dashed line. If `FALSE`, all edges are plotted as a solid line.</p></dd>


<dt>p_val, FDR, ct_val</dt>
<dd><p>filtering values. If one of these is set to `NULL` the function ignores it</p></dd>


<dt>legend_side</dt>
<dd><p>where to place the legend of the heatmap and of the annotations (if provided). See `Heatmap` 
for further details</p></dd>


<dt>community</dt>
<dd><p>logical or an object resulting from igraph community calculation. If `TRUE`, the function calculates
the communities by using fastgreedy algorithm, if `FALSE` the function does not consider communities. Otherwise, if a
community object is provided, the function uses it and colors the vertices accordingly. The communities will be
plotted as a row and column annotation of the heatmap</p></dd>


<dt>pal_community</dt>
<dd><p>vector of colors to be used to color the community annotation. If `NULL` the function will use 
`rainbow()` palette</p></dd>


<dt>label_size</dt>
<dd><p>size of the gene-set names that will be printed on the diagonal of the heatmaps</p></dd>


<dt>row_annotation, column_annotation</dt>
<dd><p>data.frame with columns corresponding to the rows or columns annotations. The rownames must 
be named after all the cells/gene-set in the `ct` tables. The values in the columns will be treated as a 
discrete variable</p></dd>


<dt>pal_row_annotation, pal_column_annotation</dt>
<dd><p>list of vectors, one for each column in `row_annotation,column_annotation` df. Each 
vector should be a color vector named after each cells/gene-set in the `ct` table. If `NULL`, the function uses `pals::alphabet2()` palette</p></dd>


<dt>row_name_side, col_name_side</dt>
<dd><p>if the name of the row/column annotation should be put at the "bottom" or "top" ("left" or "right") 
of the annotation</p></dd>


<dt>file_out</dt>
<dd><p>name used to save the jpeg file. If `NULL` the complexHeatmap object is returned</p></dd>


<dt>file_width, file_height, res, units</dt>
<dd><p>graphical value of `jpeg()` function</p></dd>


<dt>...</dt>
<dd><p>further arguments passed down to `ComplexHeatmap::Heatmap()`</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>the function produce the plot saved with the name passed to `file_out` and also returns the adjacency matrix 
and the communities (if calculated)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The functions uses `gs_cross-talk()` output to build a cross-talk network. Then, 
the adjacency matrix of the network is plotted with or without annotations on the rows and columns. The user may 
also decide which value to plot in the heatmap</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Alice Chiodi, Ettore Mosca.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

